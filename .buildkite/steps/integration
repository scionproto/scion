#!/bin/bash

set -e

run_test() {
    if [ -z "$2" ]; then
        echo "- label: Integration - ${1:?}"
    else
        echo "- label: Integration - ${1:?} mode=$2"
    fi
    echo "  command:"
    echo "  - $BASE/run_step integration $1 $2"
    echo "  timeout_in_minutes: 10"
    echo "  parallelism: 10"
    echo "  artifact_paths:"
    echo "  - \"artifacts.out/**/*\""
}

MODES="core-core noncore-localcore noncore-core noncore-noncore"

for mode in $MODES; do
    run_test "e2e_integration" "$mode"
done

run_test "py_ext_integration"
