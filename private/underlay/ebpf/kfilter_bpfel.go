// Code generated by bpf2go; DO NOT EDIT.
//go:build (386 || amd64 || arm || arm64 || loong64 || mips64le || mipsle || ppc64le || riscv64) && linux

package ebpf

import (
	"bytes"
	_ "embed"
	"fmt"
	"io"

	"github.com/cilium/ebpf"
)

type kfilterAddrPort struct {
	IpAddr  [16]uint8
	Port    uint16
	Type    uint8
	Padding uint8
}

// loadKfilter returns the embedded CollectionSpec for kfilter.
func loadKfilter() (*ebpf.CollectionSpec, error) {
	reader := bytes.NewReader(_KfilterBytes)
	spec, err := ebpf.LoadCollectionSpecFromReader(reader)
	if err != nil {
		return nil, fmt.Errorf("can't load kfilter: %w", err)
	}

	return spec, err
}

// loadKfilterObjects loads kfilter and converts it into a struct.
//
// The following types are suitable as obj argument:
//
//	*kfilterObjects
//	*kfilterPrograms
//	*kfilterMaps
//
// See ebpf.CollectionSpec.LoadAndAssign documentation for details.
func loadKfilterObjects(obj interface{}, opts *ebpf.CollectionOptions) error {
	spec, err := loadKfilter()
	if err != nil {
		return err
	}

	return spec.LoadAndAssign(obj, opts)
}

// kfilterSpecs contains maps and programs before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type kfilterSpecs struct {
	kfilterProgramSpecs
	kfilterMapSpecs
	kfilterVariableSpecs
}

// kfilterProgramSpecs contains programs before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type kfilterProgramSpecs struct {
	BpfK_filter *ebpf.ProgramSpec `ebpf:"bpf_k_filter"`
}

// kfilterMapSpecs contains maps before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type kfilterMapSpecs struct {
	K_mapFlt *ebpf.MapSpec `ebpf:"k_map_flt"`
}

// kfilterVariableSpecs contains global variables before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type kfilterVariableSpecs struct {
}

// kfilterObjects contains all objects after they have been loaded into the kernel.
//
// It can be passed to loadKfilterObjects or ebpf.CollectionSpec.LoadAndAssign.
type kfilterObjects struct {
	kfilterPrograms
	kfilterMaps
	kfilterVariables
}

func (o *kfilterObjects) Close() error {
	return _KfilterClose(
		&o.kfilterPrograms,
		&o.kfilterMaps,
	)
}

// kfilterMaps contains all maps after they have been loaded into the kernel.
//
// It can be passed to loadKfilterObjects or ebpf.CollectionSpec.LoadAndAssign.
type kfilterMaps struct {
	K_mapFlt *ebpf.Map `ebpf:"k_map_flt"`
}

func (m *kfilterMaps) Close() error {
	return _KfilterClose(
		m.K_mapFlt,
	)
}

// kfilterVariables contains all global variables after they have been loaded into the kernel.
//
// It can be passed to loadKfilterObjects or ebpf.CollectionSpec.LoadAndAssign.
type kfilterVariables struct {
}

// kfilterPrograms contains all programs after they have been loaded into the kernel.
//
// It can be passed to loadKfilterObjects or ebpf.CollectionSpec.LoadAndAssign.
type kfilterPrograms struct {
	BpfK_filter *ebpf.Program `ebpf:"bpf_k_filter"`
}

func (p *kfilterPrograms) Close() error {
	return _KfilterClose(
		p.BpfK_filter,
	)
}

func _KfilterClose(closers ...io.Closer) error {
	for _, closer := range closers {
		if err := closer.Close(); err != nil {
			return err
		}
	}
	return nil
}

// Do not access this directly.
//
//go:embed kfilter_bpfel.o
var _KfilterBytes []byte
