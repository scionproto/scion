components:
  schemas:
    Problem:
      type: object
      description: |
        Error message encoded as specified in
        [RFC7807](https://tools.ietf.org/html/rfc7807)
      properties:
        type:
          type: string
          format: uri-reference
          description: >-
            A URI reference that uniquely identifies the problem type in the
            context of the provided API.
          default: "about:blank"
          example: "/problem/policy-violation"
        title:
          type: string
          description: >-
            A short summary of the problem type. Written in English and readable
            for engineers, usually not suited for non technical stakeholders and
            not localized.
          example: Policy Violation
        status:
          type: integer
          description: >-
            The HTTP status code generated by the server for this occurrence of
            the problem.
          minimum: 100
          maximum: 599
          example: 400
        detail:
          type: string
          description: >-
            A human readable explanation specific to this occurrence of the
            problem that is helpful to locate the problem and give advice on how
            to proceed. Written in English and readable for engineers, usually
            not suited for non technical stakeholders and not localized.
          example: >-
            The CSR sent violates the certification policy of the issuing CA.
            Field CN must not contain underscore characters.
        instance:
          type: string
          format: uri-reference
          description: >-
            A URI reference that identifies the specific occurrence of the
            problem, e.g. by adding a fragment identifier or sub-path to the
            problem type.
          example: "/problem/policy-violation#cn-malformed"
        correlation_id:
          type: string
          format: uuid
          description: Identifier to correlate multiple error messages to the same case.
          example: "7D99A76F-9BA5-4C15-A1C9-114A54D9B1F1"
      required:
        - type
        - title
        - status
  responses:
    400-BadRequest:
      description: |
        The request is malformed or lacks required information.
        - Incomplete request structure (protocol error)
        - Request information violates PKI policy requirements (application error)
      content:
        application/problem+json:
          schema:
            $ref: "#/components/schemas/Problem"
    401-UnauthorizedError:
      description: |
        Authorization information missing or invalid.
          - No authentication information available (protocol error)
          - Authentication token unknown. Meaning, the Control Service has no
            access (application error)
      content:
        application/problem+json:
          schema:
            $ref: "#/components/schemas/Problem"
    404-NotFound:
      description: |
        The requested resource does not exist.
        - Request acts on an unknown resource like an unknown AS (application error)
      content:
        application/problem+json:
          schema:
            $ref: "#/components/schemas/Problem"
    500-InternalServerError:
      description: Unexpected internal server error.
      content:
        application/problem+json:
          schema:
            $ref: "#/components/schemas/Problem"
    503-ServiceUnavailable:
      description: Service unavailable due to maintenance work.
      content:
        application/problem+json:
          schema:
            $ref: "#/components/schemas/Problem"
