#!/bin/bash

CONTAINER="scion_ci"
docker stop "$CONTAINER" || true
docker rm "$CONTAINER" || true
./tools/ci/setup_container "$CONTAINER"
./tools/ci/build "$CONTAINER"
./tools/ci/lint "$CONTAINER"
./tools/ci/test "$CONTAINER"
./tools/ci/sphinx "$CONTAINER"
./tools/ci/integration "$CONTAINER"

tmpdir=$(mktemp -d /tmp/artifacts.XXXXXXX)

./tools/ci/clean_up "$tmpdir"
echo "Artifacts dir: $tmpdir"
